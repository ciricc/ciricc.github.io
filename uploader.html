<!DOCTYPE html>
<html lang="ru-ru">
  <head>
  	
  		<meta charset="utf-8">
		
	<meta name="description" content="EasyVK - это полностью бесплатный и доступный модуль, написанный для поддержки API ВКонтакте на платформе Node.js">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>EasyVK / Node.JS ВКонтакте API | Документация </title>
	
	<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
	<link rel="icon" href="favicon.ico" type="image/x-icon">

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="assets/css/bootstrap.min.css" type="text/css">
	<link rel="stylesheet" href="assets/css/main.css" type="text/css">



  </head>
  <body>
  	
  	<section class="header">
  	  
  	  <!-- 
  	  	Header section, here are logo and 
  		version selection, news and other... 
  	  -->

			<div class="opacity-block"></div>
	<div class="col-md-12">
		
		<div class="col-md-6">
			<div class="logo">
				<span class="fa fa-bars opener"></span><h2 style="display: inline-block;margin-left: 20px;" class="name-page">EasyVK <span class="small">| документация</span></h2>
			</div>
		</div>

		<div class="col-md-4">
		</div>

	</div>


  	</section>

    <section class="body-develop" style="max-height: 100%;overflow: hidden;">
    
      <!-- Start navigation block, copy/paste id :D -->


      <div class="col-md-3 docs body-elem no-padding" style="max-height: 100%;min-height: 100%;">
        <div class="docs-nav-wrap">
	<ul class="nav">
		<li>
			<a href="index.html" class="title bigger">Знакомство</a>
			<ul>
				<li>
					<a href="index.html#whatisthis">Что такое EasyVK ?</a>
				</li>
				<li>
					<a href="index.html#installation">Установка</a>
				</li>
				<li>
					<a href="index.html#info">Информация</a>
				</li>
			</ul>
		</li>
		<li>
			<a href="easyvk.html" class="title bigger">EasyVK</a>
			<ul>
				<li>
					<a href="easyvk.html#init">Авторизация</a>
				</li>
				<li>
					<a href="easyvk.html#errors">Ловля ошибок</a>
				</li>
				<li>
					<a href="easyvk.html#concepts">История EasyVK</a>
				</li>
				<li class="disable">
					<a href="#">/* API  */</a>
				</li>
				<li>
					<a href="easyvk.html#faq"><b>FAQ</b></a>
				</li>
			</ul>
		</li>
		<li>
			<a href="captcha.html" class="title bigger">Капча</a>
			<ul>
				<li>
					<a href="captcha.html#captchaHandler">captchaHandler</a>
				</li>
			</ul>
		</li>
		<li>
			<a href="methods.html" class="title bigger">Методы</a>
			<ul>
				<li>
					<a href="methods.html#vk_call"><span class="object">vk</span>.<span class="span method">call</span>()</a>
				</li>
				<li>
					<a href="methods.html#vk_saveSession"><span class="object">vk</span>.<span class="span method">saveSession</span>()</a>
				</li>
			</ul>
		</li>
		<li>
			<a href="staticmethods.html" class="title bigger">Статические методы</a>
			<ul>
				<li>
					<a href="staticmethods.html#static_call"><span class="object">static</span>.<span class="span method">call</span>()</a>
				</li>
				<li>
					<a href="staticmethods.html#static_urlencode"><span class="object">static</span>.<span class="span method">urlencode</span>()</a>
				</li>
				<li>
					<a href="staticmethods.html#static_isObject"><span class="object">static</span>.<span class="span method">isObject</span>()</a>
				</li>
				<li>
					<a href="staticmethods.html#static_isString"><span class="object">static</span>.<span class="span method">isString</span>()</a>
				</li>
				<li>
					<a href="staticmethods.html#static_checkJSONErrors"><span class="object">static</span>.<span class="span method">checkJSONErrors</span>()</a>
				</li>
				<li>
					<a href="staticmethods.html#static_checkErrors"><span class="object">static</span>.<span class="span method">checkErrors</span>()</a>
				</li>
				<li>
					<a href="staticmethods.html#static_encodeHTML"><span class="object">static</span>.<span class="span method">encodeHTML</span>()</a>
				</li>
			</ul>
		</li>
		<li>
			<a href="streamingapi.html" class="title bigger">Streaming API</a>
			<ul>
				<li>
					<a href="streamingapi.html#streamingAPI_connect"><span class="object">streamingAPI</span>.<span class="span method">connect</span>()</a>
				</li>
				<li>
					<a href="streamingapi.html#stream_addRule"><span class="object">stream</span>.<span class="span method">addRule</span>()</a>
				</li>
				<li>
					<a href="streamingapi.html#stream_deleteRule"><span class="object">stream</span>.<span class="span method">deleteRule</span>()</a>
				</li>
				<li>
					<a href="streamingapi.html#stream_deleteAllRules"><span class="object">stream</span>.<span class="span method">deleteAllRules</span>()</a>
				</li>
				<li>
					<a href="streamingapi.html#stream_close"><span class="object">stream</span>.<span class="span method">close</span>()</a>
				</li>
				<li>
					<a href="streamingapi.html#stream_initRules"><span class="object">stream</span>.<span class="span method">initRules</span>()</a>
				</li>
				<li>
					<a href="streamingapi.html#stream_getRules"><span class="object">stream</span>.<span class="span method">getRules</span>()</a>
				</li>
				<li>
					<a href="streamingapi.html#events">События стрима</a>
				</li>
			</ul>
		</li>
		<li>
			<a href="longpollapi.html" class="title bigger"><span class="no-weight">[User]</span> LongPoll API</a>
			<ul>
				<li>
					<a href="longpollapi.html#longpoll_connect"><span class="object">longpoll</span>.<span class="span method">connect</span>()</a>
				</li>
				<li>
					<a href="longpollapi.html#connection_addEventCodeListener"><span class="object">connection</span>.<span class="span method">addEventCodeListener</span>()</a>
				</li>
				<li>
					<a href="longpollapi.html#connection_debug"><span class="object">connection</span>.<span class="span method">debug</span>()</a>
				</li>
				<li>
					<a href="longpollapi.html#connection_close"><span class="object">connection</span>.<span class="span method">close</span>()</a>
				</li>
				<li>
					<a href="longpollapi.html#events">События</a>
				</li>
			</ul>
		</li>
		<li>
			<a href="botslongpollapi.html" class="title bigger"><span class="no-weight">[Bots]</span> LongPoll API</a>
			<ul>
				<li>
					<a href="botslongpollapi.html#intro">Описание</a>
				</li>
				<li>
					<a href="botslongpollapi.html#events">События</a>
				</li>
			</ul>
		</li>
		<li>
			<a href="callbackapi.html" class="title bigger">Callback API</a>
			<ul>
				<li>
					<a href="callbackapi.html#callbackAPI_listen"><span class="object">callbackAPI</span>.<span class="span method">listen</span>()</a>
				</li>
				<li>
					<a href="callbackapi.html#events">События</a>
				</li>
			</ul>
		</li>
		<li>
			<a href="uploader.html" class="title bigger">Загрузка файлов</a>
			<ul>
				<li>
					<a href="uploader.html#uploader_getUploadURL"><span class="object">uploader</span>.<span class="span method">getUploadURL</span>()</a>
				</li>
				<li>
					<a href="uploader.html#uploader_uploadFile"><span class="object">uploader</span>.<span class="span method">uploadFile</span>()</a>
				</li>
			</ul>
		</li>
		<li>
			<a href="widgets.html" class="title bigger">Виджеты</a>
			<ul>
				<li>
					<a href="widgets.html#widgets_getLiveViews"><span class="object">widgets</span>.<span class="span method">getLiveViews</span>()</a>
				</li>
			</ul>
		</li>
	</ul>
</div>
      </div>


      

      <!-- End navigation block, copy/paste id :D -->



      <div class="col-md-9 body-elem" style="max-height: 100%;min-height: 100%;">
          <div class="col-md-11 body-content">
             <!-- Content is here -->
             <h1>Загрузка файлов</h1>
             <hr>
             <div class="theme">
             	<h2 id="uploader_getUploadURL">uploader.getUploadURL(methodName, params, returnAll)</h2>
             	<p>
             		Данный метод позволяет быстро получить url для загрузки файла.
             	</p>
             	<p>
             		Первым аргументом метод принимает метод, обращаясь к котором, вы хотите получить url адрес сервера. Пример: <a href="https://vk.com/dev/photos.getWallUploadServer">photos.getWallUploadServer</a>
             	</p>
             	<p>
             		Вторым аргументом - параметры для запроса. Эти параметры вышлются вместе с GET запросом. 
             	</p>
             	<p>
             		Третий аргумент - надо ли возвращать только URL или вернуть еще и ответ сервера
             	</p>
             	<pre><code class="js">// 3 аргумент - true
{
    url: VKResponseJSON,
    vk: EasyVK,
    vkr: VKResponseJSON
}

//3 аргумент - false
{
    url: 'urlString',
    vk: EasyVK
}</code></pre>
 				<p>
 					Пример использования
 				</p>
 				<pre><code class="js">const method = 'photos.getWallUploadServer' 

const server = vk.uploader

server.getUploadURL(method,{
    group_id: '153044419'
}).then(({ url }) => {
    
    console.log(url)

}).catch(console.error)</code></pre>
             </div>

             <div class="theme">
             	<h2 id="uploader_uploadFile">uploader.uloadFile()</h2>
             	<p>
             		Данный метод загружает файл на сервер по заданному ему URL, вы можете его использовать в связке с методом <a href="#uploader_getWallUploadServer">uploader.getWallUploadServer()</a> для удобства.
             	</p>
             	<p>
             		Первый аргумент - URL адрес сервера, на который нужно будет делать POST запрос с файлом
             	</p>
             	<p>
             		Второй аргумент - filePath, путь к файлу, который надо будет отправить, используйте для генерирования пути модуль <b>path</b>, который уже встроен в Node.js
             	</p>
             	<p>
             		Третий аргумент - fieldName, это имя поля, в котором отправится файл. То есть по этому полю сервер будет искать нужный файл, как это обычно бывает, это может быть <b>photo</b> или просто <b>file</b>, уточняйте в документации API.
             	</p>
             	<p>
             	    Четвертым аргументом принимаются параметры, эти параметры могут отправиться в дополнение к файлу, но они необязательны.
             	</p>
             	<p>
             		Пример использования
             	</p>
             	<pre><code class="js">const path = require('path')
easyvk(/*параметры для авторизации*/).then(vk => {
    return vk.uploader.getUploadURL(
	    'photos.getMessagesUploadServer', {}, true
    )

}).then(async ({vk, url, vkr}) => {
    
    const field = 'photo'
    const server = vk.uploader
    const me = 356607530
    const filePath = path.join(__dirname, 'photo.png')


    url = url.response.upload_url
	
    //Загружаем файл тут
    let  {vkr: fileData} = await (server.uploadFile(url, filePath, field, {}))
	
    //Сохраняем фотографию, чтобы дальше ее прикреплять к сообщениям или куда-то еще
    fileData = await ( vk.call('photos.saveMessagesPhoto', fileData) )	
    fileData = fileData.vkr.response[0]

    //Прикрепляем к сообщению сохраненную фотку
    const attahcments = [
        `photo${fileData.owner_id}_${fileData.id}_${fileData.access_key}`
    ]

    
    //Отправляем себе фотку себя
    return vk.call('messages.send', {
        user_id: me,
        attachment: attahcments,
        message: 'Hello! Отправляю тебе мою фотку. Как тебе?'
    })

})
             	</code></pre>
             </div>
          </div>
      </div>

    </section>

    <link rel="stylesheet" href="assets/css/highlight-theme.css">
<script src="assets/plugins/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="assets/js/main.js"></script>

  </body>
</html>
