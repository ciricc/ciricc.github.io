
<!DOCTYPE html>
<html lang="ru-ru">
  <head>
  	
  		<meta charset="utf-8">
	
	<meta property="og:image"              content="http://ciricc.github.io/easyvk_poster.png" />
	
	<meta name="theme-color" content="#fff" id="theme-color">

	<meta name="description" content="EasyVK (easy vk) - это полностью бесплатный и доступный модуль, написанный для поддержки API ВКонтакте на платформе Node.js">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	
	<meta property="og:image"              content="https://psv4.userapi.com/c834502/u356607530/docs/d2/7968b5680c4c/logo.png" />
	<meta property="og:title"              content="EasyVK / Node.JS ВКонтакте API | Документация" />
	<meta property="og:description"        content="EasyVK (easy vk) - это полностью бесплатный и доступный модуль, написанный для поддержки API ВКонтакте на платформе Node.js" />

	
	
	<title>Как отправить сообщение через API ВК на Node.js</title>
	
	<link rel="shortcut icon" href="./../favicon.ico" type="image/x-icon">
	<link rel="icon" href="./../favicon.ico" type="image/x-icon">
	
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="./../assets/css/bootstrap.min.css" type="text/css">
	<link rel="stylesheet" href="./../assets/selectic/selectic.css" type="text/css">
	<link rel="stylesheet" href="./../assets/css/main.css" type="text/css">
	<link rel="stylesheet" href="./../assets/css/prism-github.css">
	<link rel="stylesheet" href="./../assets/plugins/viewer/viewer.min.css">
	<style id="theme-mode"></style>
	
	<script type="text/javascript" src="https://vk.com/js/api/openapi.js?167"></script>
	<script>
		function setCookie(e,o,n){var t=(n=n||{}).expires;if("number"==typeof t&&t){var i=new Date;i.setTime(i.getTime()+1e3*t),t=n.expires=i}t&&t.toUTCString&&(n.expires=t.toUTCString());var r=e+"="+(o=encodeURIComponent(o));for(var c in n){r+="; "+c;var a=n[c];!0!==a&&(r+="="+a)}document.cookie=r}function getCookie(e){var o=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\ ")+"=([^;]*)"));return o?decodeURIComponent(o[1]):void 0}
		
		var darkThemeCss = "body{color:#B8B8B8}#content,#sidebar,.docs,.header{background-color:#111!important;color:#B8B8B8!important}.header{background:#0E0E0E!important}.logo{display:none}.logo-white{display:inline-block}code,pre{background:#1D1D1D!important;border:none!important}code[class*=language-],pre[class*=language-]{text-shadow:none;color:#B8B8B8}.big-quote p,.nav li.active,.soc-link{background:#222!important;border:none}.post .white{background:#111!important;border:none;width:110%}.post{background-color:#111;box-shadow:none;border-radius:0}.nav li.active{background:#0D0D0D!important}.soc-link,p{color:#DADADA!important}#sidebar{border-right:none}.nav li.active>a{color:#EEE}.nav li a{color:#B8B8B8}.nav .method{color:#07A282}.nav .object{color:#C6C6C6}.nav .property{color:#07A282}.selectric,.selectric .button,select{background:#222!important;color:#EEE!important}.selectric .button:after,.selectric .label{color:#EEE!important;border-top-color:#EEE}.token.punctuation{color:#B8B8AB}.token.class-name,.token.function{color:#FFA33D}.token.string{color:#39BAB9}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#F29718}.spoiler .spoiler-name,.token.interpolation{color:#B8B8B8}.spoiler{border:none;background-color:#0C0C0C}.line-numbers .line-numbers-rows{color:#000!important;border-right-color:#B8B8B8!important}.line-numbers-rows>span:before{color:#B8B8B8!important}.nav>li>ul li a:hover{background-color:#171717}.nav>li>a:focus,.nav>li>a:hover{background-color:#0E0E0E}img{opacity:.7}.selectric-items{background:#222}.selectric-items li.selected{background:#191919}.selectric-items li{color:#EEE}.selectric-items li:hover{background:#191919;color:#EEE}.notify-block.white{background:#0D0D0D}.st-map ul{color:#B8B8B8!important}.nav li>span>a{color:#08997B}.soc-link:hover{color:white !important;text-decoration:none !important;} a.dark-link{color:#B8B8B8 !important;}#sidebar{border-right:none !important;} hr{display:none;}.big-quote p, .big-quote .p{background-color: transparent !important; border: none !important;}";
		var hours = new Date().getHours()

		;(function(){
			var themeMode = document.getElementById("theme-mode");
			var meta = document.getElementById("theme-color");

			if (getCookie("dark-mode") == "yes" || (hours >= 22 || hours < 8)) {

			if ((hours >= 22 || hours < 8) && getCookie("dark-mode") == "no") {
				} else {
					loadDarkTheme();
				}
			}

			function loadDarkTheme() {
			themeMode.cssText = darkThemeCss;
			meta.setAttribute("content", "#0E0E0E");

				// $.ajax({
				// 	url: "/assets/css/dark-theme.css",
				// 	success: function (data) {
				// 		$("#theme-mode").text(darkThemeCss);
				// 	}
				// });
			}
		})();

	</script>
	<!-- Yandex.Metrika counter -->
	<script type="text/javascript" >
	    (function (d, w, c) {
	        (w[c] = w[c] || []).push(function() {
	            try {
	                w.yaCounter50546380 = new Ya.Metrika2({
	                    id:50546380,
	                    clickmap:true,
	                    trackLinks:true,
	                    accurateTrackBounce:true,
	                    webvisor:true
	                });
	            } catch(e) { }
	        });

	        var n = d.getElementsByTagName("script")[0],
	            s = d.createElement("script"),
	            f = function () { n.parentNode.insertBefore(s, n); };
	        s.type = "text/javascript";
	        s.async = true;
	        s.src = "https://mc.yandex.ru/metrika/tag.js";

	        if (w.opera == "[object Opera]") {
	            d.addEventListener("DOMContentLoaded", f, false);
	        } else { f(); }
	    })(document, window, "yandex_metrika_callbacks2");
	</script>
	<noscript><div><img src="https://mc.yandex.ru/watch/50546380" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
	<!-- /Yandex.Metrika counter -->

  
    <script>
      
      window.root = "./../";

    </script>
  </head>
  <body>
    <div class="opacity-block">
      <div class="tap-me">
        <div class="cursor">
          <div class="tap tap--1"></div>
        </div>
        Закрыть
      </div>
    </div>
    <div class="wrap-header" style="padding: 0">
      <div class="header no-padding-mobile">
        <div class="header-content">
          <div class="col-md-12 no-padding-mobile">
            <div class="col-md-6 no-padding-mobile">
              <div class="col-md-8 col-sm-6 col-xs-8 no-padding" style="text-align: left;">
                <span class="fa fa-bars opener"></span>
                  <a href="/" class="logo">
                    <img src="./../assets/img/logo.png" style="margin-top: 12px;" alt="Easy VK логотип Node.js ВКонтакте API JavaScript" width="55" style="display: inline-block;margin-bottom: 20px;">
                  </a>
                  <a href="/" class="logo-white">
                    <img src="./../assets/img/logo-white.png" style="margin-top: 12px;" alt="Easy VK логотип Node.js ВКонтакте API JavaScript" width="55" style="display: inline-block;margin-bottom: 20px;">
                  </a>
                  <span  class="switch-mode"><span class="fa fa-moon-o"></span></span>
              </div>
              <div class="col-md-4 col-sm-6 col-xs-4" style="height: 80px;">
                <div class="version-wrap" style="text-align: center;">
                  <select name="version" id="version">
                    <a href="./../1.5.1/index.html"><option value="1.5.1">1.5.1</option></a>
                    <a href="./../2.0.0/index.html"><option value="2.0.0">2.0.0</option></a>
                    <a href="./../2.6.0/index.html"><option value="2.6.0" selected="selected">2.6.0</option></a>
                  </select>
                </div>
              </div>
            </div>
            <div class="col-md-6 soc no-mobile" style="height: 80px;">
              <div class="flex-wrap">
                <a href="https://vk.com/npm_easyvk" target="_blank" class="soc-link"><span class="fa fa-vk"></span></a>
                <a href="https://teleg.one/easyvk" target="_blank" class="soc-link" style="padding-top:1px;padding-right: 1px;"><span class="fa fa-telegram"></span></a>
                <a href="https://github.com/ciricc/easyvk" target="_blank" class="soc-link"><span class="fa fa-github"></span></a>
                <!-- Place this tag where you want the button to render. -->
                <a href="https://npmjs.com/package/easyvk" target="_blank" class="soc-link" style="font-size: 12px;"><b>npm</b></a>
              </div>
            </div>
          </div>
        </div> 
      </div>
    </div>
  	<div id="container">
      <div id="sidebar">
        <div id="sidebar-content">
          <div class="docs-nav-wrap docs">
	<div class="flex-wrap" style="margin-bottom: 25px;margin-top: 55px;justify-content: flex-start;padding-left: 25px;height:auto;">
		<a href="https://vk.com/npm_easyvk" target="_blank" class="soc-link"><span class="fa fa-vk"></span></a>
		<a href="https://teleg.one/easyvk" target="_blank" class="soc-link" style="padding-top:1px;padding-right: 1px;"><span class="fa fa-telegram"></span></a>
		<a href="https://github.com/ciricc/easyvk" target="_blank" class="soc-link"><span class="fa fa-github"></span></a>
		<!-- Place this tag where you want the button to render. -->
		<a href="https://npmjs.com/package/easyvk" target="_blank" class="soc-link" style="font-size: 12px;"><b>npm</b></a>
	</div>
	<ul class="nav">
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="./../index.html" class="title bigger">Начнем</a>
			<ul>
				<li>
					<a href="./../index.html#easyvk">Для чего нужен EasyVK?</a>
					<span>EasyVK - лучшая библиотека для работы с ВК API <br> на Node.js</span>
				</li>
				<li>
					<a href="./../index.html#functions">Функционал EasyVK</a>
					<span>Неограниченные возможности работы с API ВКонтакте</span>
				</li>
				<li>
					<a href="./../index.html#installation">Установка</a>
					<span>Простая установка</span>
				</li>
			</ul>
		</li>
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="./../easyvk.html" class="title bigger">Основное</a>
			<ul>
				<li>
					<a href="./../easyvk.html#concepts">Концепция работы с EasyVK</a>
				</li>
				<li>
					<a href="./../easyvk.html#first_step">Первый шаг</a>
					<span>Авторизация</span>
				</li>
				<li>
					<a href="./../easyvk.html#group_auth">Авторизация группы</a>
				</li>
				<li>
					<a href="./../easyvk.html#cred_flow">Client Credentials Flow</a>
					<span>Для использования secure методов</span>
				</li>
				<li>
					<a href="./../easyvk.html#app_auth">Авторизация приложения</a>
					<span>Воспользуйтесь всеми возможностями API</span>
				</li>
				<li>
					<a href="./../easyvk.html#2fauthentication">Двухфакторная авторизация</a>
					<span>Сразу ДВА фактора!</span>
				</li>
				<li>
					<a href="./../easyvk.html#faq">База знаний</a>
					<span>FAQ</span>
				</li>
				<li>
					<a href="./../easyvk.html#acknowledgments">Благодарности</a>
				</li>
			</ul>
		</li>
		<!--<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="./../tree.html" class="title bigger">Структура EasyVK (карта)</a>
			<span>Познакомьтесь со структурным деревом Easy VK, чтобы ориентироваться в документации</span>
		</li> -->
		<!-- <li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="addons.html" class="title bigger">Дополнения к Easy VK</a>
			<span>Разработки, созданные под Easy VK</span>
			<ul>
				<li>
					<a href="https://github.com/ciricc/vk-bots" target="_blank">vk-bots BETA</a>
					<span>Модуль для создания чат-ботов под Easy VK</span>
				</li>
				<li>
					<a href="https://github.com/ciricc/storybot" target="_blank">storybot BETA</a>
					<span>Бот для просмотра историй ВКонтакте (масслукинга)</span>
				</li>
				<li>
					<a href="https://github.com/khok/simple-bots" target="_blank">simple-bots</a>
					<span>Надстройка для создания чат-ботов с удобным интерфейсом</span>
				</li>
			</ul>
		</li> -->
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg><a href="./../articles.html" class="title bigger">Статьи и гайды</a>
			<span>Пишу сам, для всех нуждающихся</span>
		</li>
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="./../examples.html" class="title bigger">Примеры и шаблоны</a>
			<span>Познакомьтесь с Easy VK, прежде чем начать работу с документацией</span>
			<ul>
				<li>
					<a href="./../examples.html#bot_game">Чат-бот игра "Виселица"</a>
					<span>Опробуйте игру виселица на реальном примере чат-бота!</span>
				</li>
				<li>
					<a href="/anonletters">Анонимные письма бот</a>
					<span>Отправьте анонимное письмо любому пользователю ВКонтакте</span>
				</li>
				<li>
					<a href="./../examples.html#stories_bot">Бот, который смотрит сторис</a>
					<span>Хотели создать бота, которы будет за Вас смотреть все истории пользователей? Есть вариант!</span>
				</li>
				<li>
					<a href="./../examples.html#send_message">Отправка сообщения</a>
					<span>Работаем с методами API ВК</span>
				</li>
				<li>
					<a href="./../examples.html#chat_bot">Чат-бот</a>
					<span>Работаем с LongPoll API</span>
				</li>
			</ul>
		</li>
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="./../captcha.html" class="title bigger">Работа с капчей</a>
			<span>@ Ловите капчу! Ловите!</span>
			<ul>
				<li>
					<a href="./../captcha.html#captchaHandler">captchaHandler</a>
					<span>Основное свойство настроек EasyVK</span>
				</li>
			</ul>
		</li>
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="./../main.html" class="title bigger">Главное</a>
			<ul>
				<li>
					<a href="./../main.html#vk_call"><span class="object">vk</span>.<span class="span method">call</span>()</a>
					<span>Сделать запрос к ВК API</span>
				</li>
				<li>
					<a href="./../main.html#vk_post"><span class="object">vk</span>.<span class="span method">post</span>()</a>
					<span>Сделать запрос к ВК API по POST методу</span>
				</li>
				<li>
					<a href="./../main.html#easyvk_is"><span class="object">easyvk</span>.<span class="span method">is</span>()</a>
				</li>
				<li>
					<a href="./../main.html#easyvk_class"><span class="object">easyvk</span>.<span class="span property">class</span></a>
				</li>
				<li>
					<a href="./../main.html#easyvk_version"><span class="object">easyvk</span>.<span class="span property">version</span></a>
				</li>
				<li>
					<a href="./../main.html#easyvk_callbackapi"><span class="object">easyvk</span>.<span class="span property">callbackAPI</span> </a>
					<span>Используйте Callback API без авторизации</span>
				</li>
				<li>
					<a href="./../main.html#easyvk_streamingapi"><span class="object">easyvk</span>.<span class="span property">streamingAPI</span></a>
					<span>Используйте Streaming API без авторизации</span>
				</li>
			</ul>
		</li>
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="./../staticmethods.html" class="title bigger">Статические методы</a>
			<span>Обращение к статическим методам происходит аналогично: easyvk.static.someMethod()</span>
			<ul>
				<li>
					<a href="./../staticmethods.html#call"><span class="object">static</span>.<span class="span method">call</span>()</a>
					<span>Сделать запрос к ВК API без авторизации</span>
				</li>
				<li>
					<a href="./../staticmethods.html#createExecute"><span class="object">static</span>.<span class="span method">createExecute</span>()</a>
					<span>Создать VK Script запроса к API</span>
				</li>
				<li>
					<a href="./../staticmethods.html#randomId"><span class="object">static</span>.<span class="span method">randomId</span>()</a>
					<span>Случайное число</span>
				</li>
			</ul>
		</li>
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="./../callbackapi.html" class="title bigger">Callback API</a>
			<ul>
				<li>
					<a href="./../callbackapi.html#listen"><span class="object">callbackAPI</span>.<span class="span method">listen</span>()</a>
				</li>
				<li>
					<a href="./../callbackapi.html#events">События Callback API</a>
				</li>
			</ul>
		</li>
			<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="./../streamingapi.html" class="title bigger">Streaming API</a>
			<ul>
				<li>
					<a href="./../streamingapi.html#connect"><span class="object">streamingAPI</span>.<span class="span method">connect</span>()</a>
				</li>
				<li>
					<a href="./../streamingapi.html#stream_addRule"><span class="object">stream</span>.<span class="span method">addRule</span>()</a>
				</li>
				<li>
					<a href="./../streamingapi.html#stream_deleteRule"><span class="object">stream</span>.<span class="span method">deleteRule</span>()</a>
				</li>
				<li>
					<a href="./../streamingapi.html#stream_initRules"><span class="object">stream</span>.<span class="span method">initRules</span>()</a>
				</li>
				<li>
					<a href="./../streamingapi.html#stream_deleteAllRules"><span class="object">stream</span>.<span class="span method">deleteAllRules</span>()</a>
				</li>
				<li>
					<a href="./../streamingapi.html#stream_getRules"><span class="object">stream</span>.<span class="span method">getRules</span>()</a>
				</li>
				<li>
					<a href="./../streamingapi.html#stream_close"><span class="object">stream</span>.<span class="span method">close</span>()</a>
				</li>
				<li>
					<a href="./../streamingapi.html#stream_events">События стрима</a>
				</li>
			</ul>
		</li>
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="./../longpollapi.html" class="title bigger">LongPoll API</a>
			<ul>
				<li>
					<a href="./../longpollapi.html#connect"><span class="object">longpoll</span>.<span class="span method">connect</span>()</a>
				</li>
				<li>
					<a href="./../longpollapi.html#lpcon_addEventCodeListener"><span class="object">lpcon</span>.<span class="span method">addEventCodeListener</span>()</a>
				</li>
				<li>
					<a href="./../longpollapi.html#lpcon_debug"><span class="object">lpcon</span>.<span class="span method">debug</span>()</a>
				</li>
				<li>
					<a href="./../longpollapi.html#lpcon_close"><span class="object">lpcon</span>.<span class="span method">close</span>()</a>
				</li>
				<li>
					<a href="./../longpollapi.html#longpoll_events">События</a>
				</li>
			</ul>
		</li>
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="./../botslongpollapi.html" class="title bigger">[Bots] LongPoll API</a>
			<ul>
				<li>
					<a href="./../botslongpollapi.html#description">Описание</a>
				</li>
				<li>
					<a href="./../botslongpollapi.html#events">События</a>
				</li>
			</ul>
		</li>
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="./../http.html" class="title bigger">HTTP</a>
			<span>С помощью HTTP клиента можно делать то, что нельзя делать с официальным API <br>Связующие компоненты: <a href="">Client</a></span>
			<ul>
				<li>
					<a href="./../http.html#loginByForm"><span class="object">http</span>.<span class="span method">loginByForm</span>()</a>
				</li>
			</ul>
		</li>
		<li>
			<a href="./../httpclient.html" class="title bigger">HTTP клиент</a>
			<ul>
				<li>
					<a href="./../httpclient.html#client_readstories"><span class="object">client</span>.<span class="span method">readStories</span>()</a>
					<span>Посмотреть истории пользователя</span>
				</li>
				<li>
					<a href="./../httpclient.html#client_readfeedstories"><span class="object">client</span>.<span class="span method">readFeedStories</span>()</a>
					<span>Посмотреть все новые истории друзей</span>
				</li>
				<li>
					<a href="./../httpclient.html#client_request"><span class="object">client</span>.<span class="span method">request</span>()</a>
					<span>Управляй сам</span>
				</li>
				<!-- <li>
					<a href="httpclient.html#client_audio"><span class="object">client</span>.<span class="span span property">audio</span></a>
					<span>
						Это объект <a href="audioapi.html">AudioAPI</a>
					</span>
				</li> -->
			</ul>
		</li>
		<!-- <li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="audioapi.html" class="title bigger">Audio API</a>
			<span>Со временем возможно устревание, следите, чтобы всегда была последняя версия Audio API</span>
			<ul>
				<li>
					<a href="audioapi.html#audio_get"><span class="object">audio</span>.<span class="span method">get</span>()</a>
					<span>Получить аудиозаписи</span>
				</li>
				<li>
					<a href="audioapi.html#audio_getbyid"><span class="object">audio</span>.<span class="span method">getById</span>()</a>
					<span>Получить аудиозапись</span>
				</li>
				<li>
					<a href="audioapi.html#audio_search"><span class="object">audio</span>.<span class="span method">search</span>()</a>
					<span>Поиск аудиозаписей</span>
				</li>
				<li>
					<a href="audioapi.html#audio_searchall"><span class="object">audio</span>.<span class="span method">searchAll</span>()</a>
					<span>Поиск множества аудиозаписей сразу</span>
				</li>
				<li>
					<a href="audioapi.html#audio_getlyrics"><span class="object">audio</span>.<span class="span method">getLyrics</span>()</a>
					<span>(<b>ЛУЧШЕ НЕ ИСПОЛЬЗОВАТЬ</b>)</span>
				</li>
				<li>
					<a href="audioapi.html#audio_getcount"><span class="object">audio</span>.<span class="span method">getCount</span>()</a>
				</li>
				<li>
					<a href="audioapi.html#audio_getuploadserver"><span class="object">audio</span>.<span class="span method">getUploadServer</span>()</a>
				</li>
				<li>
					<a href="audioapi.html#audio_upload"><span class="object">audio</span>.<span class="span method">upload</span>()</a>
				</li>
				<li>
					<a href="audioapi.html#audio_save"><span class="object">audio</span>.<span class="span method">save</span>()</a>
				</li>
				<li>
					<a href="audioapi.html#audio_geturl"><span class="object">audio</span>.<span class="span method">getURL</span>()</a>
				</li>
				<li>
					<a href="audioapi.html#audio_add"><span class="object">audio</span>.<span class="span method">add</span>()</a>
				</li>
				<li>
					<a href="audioapi.html#audio_delete"><span class="object">audio</span>.<span class="span method">delete</span>()</a>
				</li>
				<li>
					<a href="audioapi.html#audio_edit"><span class="object">audio</span>.<span class="span method">edit</span>()</a>
				</li>
				<li>
					<a href="audioapi.html#audio_reorder"><span class="object">audio</span>.<span class="span method">reorder</span>()</a>
				</li>
				<li>
					<a href="audioapi.html#audio_restore"><span class="object">audio</span>.<span class="span method">restore</span>()</a>
				</li>
				<li>
					<a href="audioapi.html#audio_getPlaylists"><span class="object">audio</span>.<span class="span method">getPlaylists</span>()</a>
				</li>
				<li>
					<a href="audioapi.html#audio_getPlaylistById"><span class="object">audio</span>.<span class="span method">getPlaylistById</span>()</a>
				</li>
				<li>
					<a href="audioapi.html#audio_followPlaylist"><span class="object">audio</span>.<span class="span method">followPlaylist</span>()</a>
				</li>
				<li>
					<a href="audioapi.html#audio_deletePlaylist"><span class="object">audio</span>.<span class="span method">deletePlaylist</span>()</a>
				</li>
				<li>
					<a href="audioapi.html#audio_moveToPlaylist"><span class="object">audio</span>.<span class="span method">moveToPlaylist</span>()</a>
				</li>
				<li>
					<a href="audioapi.html#playlist"><span class="span method">Playlist</span></a>
				</li>
				<li>
					<a href="audioapi.html#audioitem"><span class="span method">AudioItem</span></a>
				</li>
				<li>
					<a href="audioapi.html#apiJSON"><span class="span method">JSON Audio API</span></a>
				</li>
			</ul>
		</li> -->
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="./../session.html" class="title bigger">Сессия</a>
			<ul>
				<li>
					<a href="./../session.html#save"><span class="object">session</span>.<span class="span method">save</span>()</a>
				</li>
				<li>
					<a href="./../session.html#setPath"><span class="object">session</span>.<span class="span method">setPath</span>()</a>
				</li>
				<li>
					<a href="./../session.html#clear"><span class="object">session</span>.<span class="span method">clear</span>()</a>
				</li>
				<li>
					<a href="./../session.html#usage"><span class="object">Метод использования</span></a>
				</li>
			</ul>
		</li>
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg><a href="./../uploader.html" class="title bigger">Загрузчик файлов</a>
			<span>Свободно загружайте нужные файлы на сервера ВКонтакте</span>
			<ul>
				<li>
					<a href="./../uploader.html#uploader_getUploadURL"><span class="object">uploader</span>.<span class="span method">getUploadURL</span>()</a>
					<span>Получите URL для загрузки</span>
				</li>
				<li>
					<a href="./../uploader.html#uploader_uploadFile"><span class="object">uploader</span>.<span class="span method">uploadFile</span>()</a>
					<span>И загрузите файл</span>
				</li>
				<li>
					<a href="./../uploader.html#uploader_uploadFetchedFile"><span class="object">uploader</span>.<span class="span method">uploadFetchedFile</span>()</a>
					<span>Все само</span>
				</li>
				<li>
					<a href="./../uploader.html#uploader_upload"><span class="object">uploader</span>.<span class="span method">upload</span>()</a>
					<span>Швейцарский нож</span>
				</li>
			</ul>
		</li>
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg><a href="./../widgets.html" class="title bigger">Виджеты</a>
			<span>Неофициальные инструменты для получения чего-либо, что нельзя получить официально через API</span>
			<ul>
				<li>
					<a href="./../widgets.html#widgets_getliveviews"><span class="object">widgets</span>.<span class="span method">getLiveViews</span>()</a>
					<span>Просмотры LIVE видео</span>
				</li>
			</ul>
		</li>
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg><a href="./../debugger.html" class="title bigger">Debugger</a>
			<span>Инструмент для дебага запросов и деятельности EasyVK в режиме реального времени</span>
			<ul>
				<li>
					<a href="./../debugger.html#how_to_work"><span class="object">Debugger</span></a>
					<span>Узнайте как использовать Debugger в своих программах</span>
				</li>
				<li>
					<a href="./../debugger.html#connect"><span class="object">Подключение</span></a>
					<span>Используем дебаг в Easy VK</span>
				</li>
				<li>
					<a href="./../debugger.html#EVENTS"><span class="object">Debugger EVENTS</span></a>
					<span>Типы событий в объекте</span>
				</li>
				<li>
					<a href="./../debugger.html#EventContext"><span class="object">EventContext</span></a>
					<span>Объект события и работа с ним</span>
				</li>
				<li>
					<a href="./../debugger.html#request"><span class="object">Запрос</span></a>
					<span>События запроса</span>
				</li>
				<li>
					<a href="debugger.html#response"><span class="object">Ответ</span></a>
					<span>События ответа</span>
				</li>
			</ul>
		</li>
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="./../vkresponse.html" class="title bigger">VKResponse</a>
			<ul>
				<li>
					<a href="./../vkresponse.html#getFullResponse"><span class="object">vkr</span>.<span class="span method">getFullResponse</span>()</a>
				</li>
			</ul>
		</li>
		<li>
			<svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg> <a href="./../errors.html" class="title bigger">Классификация ошибок</a>
			<ul>
				<li>
					<a href="./../errors.html#easyvkerror"><span class="span method">EasyVKError</span></a>
				</li>
				<li>
					<a href="./../errors.html#vkresponseerror"><span class="span method">VKResponseError</span></a>
				</li>
			</ul>
		</li>
	</ul>
</div>
        </div>
      </div><!--
    --><div id="content" class="v2">
       
        <div id="main-content" style="max-width: 910px;">
          

<h1>Как отправить сообщение через API ВК на Node.js <span class="date-edit">Редактировано: <span class="det">15.05.2020 в 23:49</span></span></h1>
<b>Структура статьи</b>
<p>
  <ul>
    <li><a href="#begin">Знакомство с методом messages.send</a></li>
    <li><a href="#send_user_message">Отправка сообщения от лица пользователя</a></li>
    <li><a href="#send_group_message">Отправка сообщения от лица сообщества</a></li>
    <li><a href="#send_message_conversation">Отправка сообщения в беседу</a></li>
    <li><a href="#send_group_message_conversation">Отправка сообщения в беседу от имени сообщества</a></li>
    <li><a href="#send_after_join">Как отправлять сообщение от имени сообщества после приглашения в беседу</a></li>
    <li><a href="#send_sticker">Как отправить стикер</a></li>
    <li><a href="#send_sticker_like_graffiti">Отправляем стикер в виде граффити</a></li>
    <li><a href="#send_voice_audio_message">Как отправить голосовое сообщение</a></li>
    <li><a href="#send_image">Как отправить изображение</a></li>
  </ul>
</p>
<h3><span id="begin"></span>Знакомство с методом messages.send</h3>
<p>
  Если вы уже знакомы с тем, как использовать API ВКонтакте, то скорее всего вы захотели сделать первый шаг в работе с ним. Лично я начал свое погружение в VK API именно с секции сообщений. Сначала это была просто тестовая отправка сообщения.
</p>
<p>
  И так, для того, чтобы отправлять сообщения, в VK API есть метод <a href="https://vk.com/dev/messages.send" target="_blank">messages.send</a>
</p>
<p>
  Минимальные параметры для отправки
  <ul>
    <li>
      <b>peer_id</b> - ID отправителя: беседа, или человек, или сообщество
    </li>
    <li>
      <b>message</b> - Текст сообщения, если не указан параметр attachment или sticker_id
    </li>
    <li>
      <b>attachment</b> - Массив с прикреплениями (точнее, строка, разделяющая прикрепления через запятую)
    </li>
    <li>
      <b>sticker_id</b> - ID стикера
    </li>
    <li><b>random_id</b> - Случайное число, для предотвращения дубликатов сообщений. Для простоты генерации, привязывайте его к текущей дате</li>
  </ul>
</p>
<p>
  Чтобы обращаться к VK API на Node.js, я всегда использую модуль <a href="/">easyvk</a>. Есть и другие варианты, например, <a href="https://www.npmjs.com/package/vk-io" target="_blank">vk-io</a> или <a href="https://www.npmjs.com/package/node-vk-bot-api" target="_blank">node-vk-bot-api</a>. Что использовать, решать вам. Но писать статьи я решил с примерами использования easyvk, так как эта библиотека мне знакома больше, чем любая другая, хотябы потому что я ее автор :)
</p>
<p>
  На <a href="https://ciricc.github.io">сайте-документации</a> модуля написано подробно о том, как его установить и использовать. 
</p>
<h2>Примеры</h2>
<p>
  Чтобы эта и другие мои статьи о VK API не получились как все типичные статьи из интернета, я буду меньше говорить, и больше показывать.
</p>
<h3><span id="send_user_message"></span>Отправка сообщения от лица пользователя</h3>
<p>
  Чтобы отправить сообщение от лица пользователя, вам понадобится:
  <ul>
    <li>Токен пользователя</li>
    <li>Доступ к секции <b>messages</b></li>
  </ul>
</p>
<p>
  Хотелось бы напомнить, что Messages API официально закрыт для аккаунтов ВКонтакте, но это не значит, что им нельзя пользоваться. В библиотеке easyvk, для получения доступа, авторизация происходит по данным официальных клиентов ВКонтакте (Приложение для Android, например), которые уже имеют доступ к секции Messages API. Вам почти ничего не надо делать для успешной отправки первого сообщения.
</p>
<p>
  Теперь сам пример
</p>
<pre  class='line-numbers normalize-whitespace'><code class='language-js'>const easyvk = require('easyvk') // Подключаем easyvk

easyvk({ /** Авторизуемся */
  username: 'ВАШ_ЛОГИН',
  password: 'ВАШ_ПАРОЛЬ'
}).then(async (vk) => {
  
  /** Отправляем сообщение */
  let response = await vk.call('messages.send', {
    /** Отправляем самому себе */
    peer_id: vk.session.user_id,
    message: "Привет!",
    /** Получаем случайное число с привязкой к дате*/
    random_id: easyvk.randomId()
  })
  
  console.log(response) // Выводим ID отправленного сообщения

})</code></pre>
<p>
  Если все получилось, вам придет сообщение с текстом <code>Привет!</code>
</p>
<h3><span id="send_group_message"></span>Отправка сообщения от лица сообщества</h3>
<p>
  Чтобы отправить сообщение от лица сообщества, вам понадобится:
  <ul>
    <li>Токен сообщества</li>
    <li>Доступ к секции <b>messages</b></li>
    <li>Доступ к диалогку с пользователем, которому хотите отправить сообщение</li>
  </ul>
</p>
<p>
  Как получить токен сообщества самым простым методом, я описал в <a href="how_to_get_group_token_easy.html" target="_blank">этой статье </a>
</p>
<p>
  Чтобы получить доступ к диалогу с пользователем, он должен отправить вам любое сообщение
</p>
<p>
  Параметры все те же.
</p>
<pre  class='line-numbers normalize-whitespace'><code class='language-js'>const easyvk = require('easyvk')

easyvk({
  token: 'ВАШ ТОКЕН СООБЩЕСТВА'
}).then(async vk => {
    
  let peerId = 1 // ID получателя

  /** Отправляем сообщение */
  let response = await vk.call('messages.send', {
    peer_id: peerId,
    message: "Привет!",
    /** Получаем случайное число с привязкой к дате*/
    random_id: easyvk.randomId()
  })
  
  console.log(response) // Выводим ID отправленного сообщения
})</code></pre>
<p>
  Если все получилось, сообщество отправило сообщение с текстом <code>Привет!</code>
</p>
<h3><span id="send_message_conversation"></span>Отправка сообщения в беседу</h3>
<p>
  Для отправки сообщения в беседу в параметре <b>peer_id</b> нужно указать число <code>2000000000 + ID беседы</code>. ID беседы вы можете получить любым удобным способом: через метод <a href="https://vk.com/dev/messages.getConversations" target="_blank">messages.getConversations</a> или по ссылке ВКонтакте <br>
  <img src="https://imgur.com/uu0Kc9L.png" alt="https://vk.com/im?sel=c{ID беседы}">
</p>
<pre  class='line-numbers normalize-whitespace'><code class='language-js'>const easyvk = require('easyvk') // Подключаем easyvk

easyvk({
  username: 'ВАШ_ЛОГИН',
  password: 'ВАШ_ПАРОЛЬ'
}).then(async vk => {
  
  /** Получаем список бесед */
  let conversations = await vk.call('messages.getConversations')
  conversations = conversations.items.filter(a => 
    a.conversation && a.conversation.peer.type === "chat"
  )
  
  if (conversations.length) {
    let response = await vk.call('messages.send', {
      peer_id: conversations[0].conversation.peer.id,
      message: "Всем привет!"
    })

    console.log(response)
  }

})</code></pre>
<h3><span id="send_group_message_conversation"></span>Отправка сообщения в беседу от имени сообщества</h3>
<p>
  Чтобы сообщество могло отправлять сообщения в беседу, сначала необходимо это сообщество пригласить в эту самую беседу. Для этого в настройках сообщества надо включить возможности для чат-ботов и открыть специальный сервис для приглашений.
</p>
<p>
  <img src="https://imgur.com/CAdM4ZI.png" alt="Настройки сообщества">
</p>
<p>
  Сервис можно будет найти в меню сообщества
</p>
<p>
  <img src="https://imgur.com/WRAOGhe.png" alt="Сервис для приглашений">
</p>
<p>
  Пишем код
</p>
<pre  class='line-numbers normalize-whitespace'><code class='language-js'>const easyvk = require('easyvk') // Подключаем easyvk

easyvk({
  token: 'ТОКЕН СООБЩЕСТВА'
}).then(async vk => {
  
  let response = await vk.call('messages.send', {
    /** 
      ID беседы для сообщества.
      Как его получить, читайте ниже
    */
    peer_id: 2000000009,
    message: "Всем привет!"
  })

  console.log(response) // Всегда 0

})
</code></pre>
<h3><span id="send_after_join"></span>Как отправлять сообщение от имени сообщества после приглашения в беседу</h3>
<p>
  Это мы уже переходим к разработке мини-чат-бота. Но, конечно, это не он.
</p>
<p>
  Сначала включаем Bots LongPoll (пример будет описан на нем, так как его сможет запустить каждый желающий, позже я буду показывать примеры создания чат-ботов с помощью Callback API тоже)
</p>
<p>
  Для этого заходим в настройки сообщества. И включаем все, что касается LongPoll. А именно: 
</p>
<p>
  <img src="https://imgur.com/mGvN0Wp.png" alt="Настройки сообщества (Работа с API, выставляйте новейшую версию API)">
</p>
<p>
  Мы будем отправлять сообщение сразу после того, как сообщество пригласили в беседу. Включим поддержку события входящего сообщения в настройках, так как информация о приглашении придет именно как сообщение.
</p>
<p>
  <img src="https://imgur.com/jewPY3f.png" alt="Включаем событие входящего сообщения">
</p>
<p>
  Теперь подключим Bots LongPoll в easyvk. Не забываем, что приглашение - это обычное входящее сообщение.
</p>
<pre  class='line-numbers normalize-whitespace'><code class='language-js'>const easyvk = require('easyvk')

easyvk({
  token: 'ТОКЕН СООБЩЕСТВА',
  reauth: true,
  v: '5.103' // Обязательно используем новейшую версию ВКонтакте
}).then(async vk => {
  
  /** Подключаемся к LongPoll */
  let connection = await vk.bots.longpoll.connect();
  
  /** Выставляем прослушивание сообщений */
  connection.on("message_new", async (msg) => {
    
    /** Проверяем, что это приглашение в беседу */
    if (
      msg.message && 
      msg.message.action && 
      msg.message.action.type === "chat_invite_user" &&

      /** Проверка, что пригласили именно наше сообщество */
      msg.message.action.member_id === -vk.session.group_id) {
  
      /** Отправляем приветственное сообщение */
      let res = await sendHelloMessage(msg.message.peer_id)
      
      console.log(res) // Всегда 0
    }
  })
  
  async function sendHelloMessage (peerId) {
    return vk.call('messages.send', {
      peer_id: peerId,
      random_id: easyvk.randomId(),
      message: "Всем привет!"
    })
  }

})</code></pre>
<p>
  Теперь сообщество будет кидать всем беседам приветственное сообщение сразу после приглашения.
</p>
<h3><span id="send_sticker"></span>Отправка стикера</h3>
<p>
  ВКонтакте позволяет отправлять стикеры в сообщениях. Честно говоря, мне доводилось только один раз прибегать к отправке стикера. Это было, когда я писал чат-бота для глобальных бесед. Там надо было как-то реализовать пересылку любого стикера, который бы отправил пользователь. По-моему, у меня не получилось. Точнее, это работало только с бесплатными стикерами. Самое время разобраться в этом вопросе поглубже.
</p>
<p>
  Все тот же messages.send
</p>
<pre  class='line-numbers normalize-whitespace'><code class='language-js'>
easyvk({
  username: 'ВАШ_ЛОГИН',
  password: 'ВАШ_ПАРОЛЬ'
}).then(async vk => {

  /** Получаем недавно использованные стикеры */
  let response = await vk.call('messages.getRecentStickers')
  let recentStickers = response.items;
  
  /** Отправляем самому себе стикер */
  await vk.call('messages.send', {
    peer_id: vk.session.user_id,
    sticker_id: recentStickers[0].sticker_id,
    random_id: easyvk.randomId()
  })

})
</code></pre>
<p>
  Если все получилось, то стикер отправился.
</p>
<h3><span id="send_sticker_like_graffiti"></span>Отправка стикера как граффити</h3>
<p>
  Да-да. И такое бывает. Особенно в последнее время. На сколько мне известно, на данный момент ВКонтакте хранит у себя на серверах 19к стикеров (там почти 20). И все они очень разные, прикольные. Некоторые уже нигде не найти. Но они все равно хранятся. Как в общем-то и любая другая информация в ВК. И это если не считать кастомных стикеров, которые люди загружают как граффити. Разберемся, как они это делают.
</p>
<p>
  Граффити - это обычный документ, загруженный как png изображение. В ВК граффити отображается почти также, как стикер. В некоторых местах, разве что, он бывает в разы больше стикера. А значит и загружать мы его будем как документ.
</p>
<p>
  Для примера возьмем вот такой прикольный стикер <a href="https://vk.com/sticker/1-5041-352" target="_blank">https://vk.com/sticker/1-5041-352</a> <br>
  <img src="https://vk.com/sticker/1-5041-256" alt="Тупа я каждый день">
</p>
<p>
  Воспользуемся компонентом <code>uploader</code> для загрузки файла.
</p>
<pre  class='line-numbers normalize-whitespace'><code class='language-js'>
easyvk({
  username: 'ВАШ_ЛОГИН',
  password: 'ВАШ_ПАРОЛЬ'
}).then(async vk => {

  let {graffiti} = await vk.uploader.upload({
    getUrlMethod: 'docs.getUploadServer', // Метод получения URL
    getUrlParams: {
      type: 'graffiti' // Отправляем как граффити
    },
    file: 'https://vk.com/sticker/1-162-256', // Что загружаем
    isWeb: true, // Просим скачать файл с удаленного сервера
    saveMethod: 'docs.save' // Сохраняем этим методом
  })

  /** Отправляем самому себе */
  await vk.call('messages.send', {
    peer_id: vk.session.user_id,
    attachment: `graffiti${graffiti.owner_id}_${graffiti.id}`,
    random_id: easyvk.randomId()
  })

})
</code></pre>
<p>
  Вот есть еще такие стикосы
</p>

<img src="https://vk.com/sticker/1-9486-256" alt="">
<img src="https://vk.com/sticker/1-3045-256" alt="">
<img src="https://vk.com/sticker/1-16896-256" alt="">
<h3><span id="send_voice_audio_message"></span>Отправка голосового сообщения</h3>
<p>
  Происходит таким же образом, как и отправка любого документа.
</p>
<p>
  Чтобы отправить голосовое сообщене, вам необходимо его записать в формате Ogg Opus (.ogg). Вы можете записать его в любом другом формате, а затем воспользоваться <code>ffmpeg</code> для форматирования его уже в .ogg, но главное, чтобы в итоге у вас получился файл <code>ogg</code>!
</p>
<pre class="shell" class='line-numbers normalize-whitespace'><code class='language-js'>ffmpeg -i audio.wav  -acodec libvorbis audio.ogg</code></pre>
<p>
  Если вам интересна тема работы с аудио и тем, как я сделал наложение эффектов на голосовое сообщение (реверберация, дисторшн и другие), то можете почитать <a href="">эту статью</a>
</p>
<p>
  А пока что я покажу простейший пример отправки голосового сообщения
</p>
<pre  class='line-numbers normalize-whitespace'><code class='language-js'>const easyvk = require('easyvk')

easyvk({
  username: 'ВАШ_ЛОГИН',
  password: 'ВАШ_ПАРОЛЬ'
}).then(async vk => {
  let peerId = vk.session.user_id
  let fileName = 'file.ogg'
  
  /** Получаем URL для загрузки */
  let {upload_url: uploadUrl} = await vk.call('docs.getMessagesUploadServer', {
    peer_id: peerId,
    type: "audio_message"
  })
  
  /** Загружаем файл */
  let file =  await vk.uploader.uploadFile(uploadUrl, fileName)
  let doc = await vk.post('docs.save', file)

  doc = doc.audio_message;
  
  await vk.call('messages.send', {
    peer_id: peerId,

    /** Прикрепляем файл как обычный документ */
    attachment: `doc${doc.owner_id}_${doc.id}_${doc.access_key}`,
    random_id: easyvk.randomId()
  })

})
</code></pre>
<p>
  Кстати говоря, отправка аудио сообщений работает и для сообществ! Просто используйте <code>access_token</code> сообщества для настройки под вас.
</p>
<h3><span id="send_image"></span>Отправляем изображение</h3>
<p>
  Вообще, есть два варианта отправки изображения.
  <ul>
    <li>Изображение с жесткого диска</li>
    <li>Изображение с удаленного сервера (по URL)</li>
  </ul>
</p>
<p>
  Оба способа поддерживаются в easyvk, поэтому я покажу оба варианта загрузки.
</p>
<p>
  Возьмем какую-нибудь забугорную картинку, почему - не знаю. Просто так. Загрузим ее куда-нибудь в личные сообщения.
</p>
<p>
  <img src="https://i.imgur.com/PXajpyw.jpg" alt="Panic Kalm memes" width="420">
</p>
<p>
  Для загрузки файла с другого сервера в easyvk есть метод <code>vk.uploader.uploadFetchedFile()</code>
</p>
<p>
  Для загрузки файла с жесткого диска в easyvk есть метод <code>vk.uploader.uploadFile()</code>
</p>
<p>
  Напишем код
</p>
<pre  class='line-numbers normalize-whitespace'><code class='language-js'>const easyvk = require('easyvk')

easyvk({
  username: 'ВАШ_ЛОГИН',
  password: 'ВАШ_ПАРОЛЬ'
}).then(async vk => {
  let peerId = vk.session.user_id
  let fileName = 'https://i.imgur.com/PXajpyw.jpg'

  /** Локальная картинка */
  let localFileName = './img.png'
  
  /** Получаем URL для загрузки */
  let {upload_url: uploadUrl} = await vk.call('photos.getMessagesUploadServer', {
    peer_id: peerId
  })
  
  /** Загружаем файл (url, file, field - photo, как в документации) */
  let file =  await vk.uploader.uploadFetchedFile(uploadUrl, fileName, 'photo')
  let localFile =  await vk.uploader.uploadFile(uploadUrl, localFileName, 'photo')

  /** Сохряняем оба изображения */
  let photo = await vk.post('photos.saveMessagesPhoto', file)
  let localPhoto = await vk.post('photos.saveMessagesPhoto', localFile)

  photo = photo[0]
  localPhoto = localPhoto[0]


  /** Отправляем сообщение */
  await vk.call('messages.send', {
    peer_id: peerId,

    /** Прикрепляем файл как обычный документ */
    attachment: [
      `photo${photo.owner_id}_${photo.id}_${photo.access_key}`, 
      `photo${localPhoto.owner_id}_${localPhoto.id}_${localPhoto.access_key}`
    ],
    random_id: easyvk.randomId()
  })

})
</code></pre>
<p>
  На этом все! Спасибо, что дочитали до конца. Надеюсь, что эта статья вам хоть чем-то помогла и вы научились чему-то новому :)
</p>
<p>
  Ссылки
  <ul>
    <li><a href="how_to_get_group_token_easy.html" target="_blank">Как получить токен сообщества ВКонтакте самым простым методом</a></li>
    <li><a href="how_to_send_voice_audio_message_vkontakte_with_sound_effects.html" target="_blank">Отправляем голосовое сообщение ВКонтакте с эффектами</a></li>
  </ul>
</p>

<div class="comments-wrap">
  <div class="comments-wrap-header"><h4>Комментарии к статье</h4> <div id="vk_like"></div></div>
  <div id="vk_comments"></div>
</div>
        </div>
        <div class="col-md-12 no-padding">
          <div class="col-md-11 no-padding">
            
          </div>
          </div>
          <div class="footer">
            <p>
              Easy VK &copy; 2020 - Кирилл Новак<br>
            </p>
          </div>
          <div class="star" style="margin-bottom: 50px;">
            <p>
              <a class="github-button" href="https://github.com/ciricc/easyvk" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star ciricc/easyvk on GitHub" style="margin: 5px 15px;display: inline-block;">Мне нравится EasyVK</a>
            </p>
          </div>
      </div>
    </div>

    <!-- <link rel="stylesheet" href="assets/css/highlight-theme.css"> -->
<!-- <script src="assets/plugins/highlight/highlight.pack.js"></script> -->
<!-- <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script> -->
<!-- <script>hljs.initHighlightingOnLoad();</script> -->
<script src="./../assets/plugins/prism.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="./../assets/plugins/viewer/viewer.min.js"></script>
<script src="./../assets/plugins/viewer/jquery-viewer.min.js"></script>

<script src="./../assets/js/main.js"></script>
<script src="./../assets/selectic/selectic.min.js"></script>
<script>
;(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://easyvkdocument.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<!-- Place this tag in your head or just before your close body tag. -->
<script async defer src="https://buttons.github.io/buttons.js"></script>
<script type="text/javascript">
  VK.init({apiId: 7373144, onlyWidgets: true});
</script>
<script type="text/javascript">
VK.Widgets.Comments("vk_comments", {limit: 20, attach: "*"});
VK.Widgets.Like("vk_like", {type: "button"});
</script>

  </body>
</html>
